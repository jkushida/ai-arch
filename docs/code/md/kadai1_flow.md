# 課題1：【初級】PSOによる建築最適化を体験しよう - 学習フロー

## 🎯 課題のゴール
PSO（粒子群最適化アルゴリズム）がどのようにして最適な建築設計を見つけ出すのか、その一連のプロセスを体験し、結果を分析・考察できるようになる。

---

## 🗺️ 学習の全体像

この課題は、大きく分けて以下の4つのステップで進みます。

1.  **【実行と観察】** PSOによる最適化計算を実行し、その過程をリアルタイムで観察する。
2.  **【結果の記録】** PSOが見つけ出した「最も良い」とされる建築のパラメータ（寸法や材料など）を記録する。
3.  **【設計の再現】** 記録したパラメータを元に、最適化された建築の3Dモデルを生成する。
4.  **【分析と考察】** 生成された3Dモデルと評価データを見ながら、なぜその設計が最適と判断されたのかを分析し、レポートにまとめる。

---

## 🚀 具体的な学習ステップ

### ステップ1：最適化の実行とプロセスの観察

PSOに「良い建築を探して」と指示を出すフェーズです。

1.  **実行準備:**
    *   ターミナル（コマンドプロンプトやPowerShellなど）を**2つ**開きます。

2.  **最適化の開始:**
    *   **1つ目**のターミナルで、以下のコマンドを実行し、最適化計算を開始します。
      ```bash
      # Windowsの場合
      & "C:\Program Files\FreeCAD 1.0\bin\freecadcmd.exe" pso_algorithm.py

      # Macの場合
      /Applications/FreeCAD.app/Contents/Resources/bin/freecadcmd code/pso_algorithm.py
      ```

3.  **モニタリングの開始:**
    *   **2つ目**のターミナルで、以下のコマンドを実行し、監視用のWebサーバーを起動します。
      ```bash
      # Windows / Mac 共通
      python3 code/monitor_pso_mac.py
      ```

4.  **プロセスの観察:**
    *   **ターミナル（1つ目）**: 計算の進捗（反復回数、その時点での最良スコア）がテキストで流れていきます。数値がどのように変化していくか眺めましょう。
    *   **Webブラウザ**: `http://localhost:5001` にアクセスします。最適化の様子がグラフで可視化されています。
        *   **収束曲線**: 右肩下がりにグラフが下がっていく様子を確認します。
        *   **粒子群の動き**: パラメータ空間で粒子（設計案）がどのように最適解を探しているか観察します。
    *   **📝メモ**: この観察結果は、後の**提出課題1-a「最適化プロセスの観察」**で必要になります。気づいたこと（例：「10回目くらいから変化が緩やかになった」など）をメモしておきましょう。

---

### ステップ2：最適化結果（最良パラメータ）の記録

計算が完了すると、PSOが見つけた「答え」がターミナルに表示されます。

1.  最適化が完了したターミナル（1つ目）に、`最良パラメータ:`として21個の項目（`Lx`, `Ly`, `H1`...）とそれぞれの数値が表示されます。
2.  この**パラメータ一式をすべてコピー**し、メモ帳などに貼り付けて保存してください。これがPSOによる設計案の「設計図」になります。

---

### ステップ3：最適化された建物の3Dモデル生成

ステップ2で得た「設計図」を元に、実際の建物の3Dモデルを作成します。

1.  **準備:**
    *   `code`フォルダにある`test_generate_building.py`をコピーし、`test_optimal_building.py`という名前で複製します。

2.  **パラメータの反映:**
    *   作成した`test_optimal_building.py`をテキストエディタで開きます。
    *   ファイルの中にある`test_parameters`という辞書（`{}`で囲まれた部分）の中身を、**ステップ2でコピーしたあなたのパラメータにすべて書き換え**ます。

3.  **3Dモデル生成の実行:**
    *   ターミナルで以下のコマンドを実行します。
      ```bash
      # Windowsの場合
      & "C:\Program Files\FreeCAD 1.0\bin\freecadcmd.exe" test_optimal_building.py

      # Macの場合
      /Applications/FreeCAD.app/Contents/Resources/bin/freecadcmd test_optimal_building.py
      ```

4.  **結果の確認と記録:**
    *   実行が完了すると、プロジェクトのルートフォルダに`optimal_building.FCStd`という3Dモデルファイルが生成されます。
    *   同時に、ターミナルにはその建物の評価結果（安全率、コスト、CO2排出量など）が表示されます。この評価結果も**提出課題1-c**で必要になるので記録しておきましょう。

---

### ステップ4：分析、考察、レポート作成

最後に、これまでの結果をまとめて、学びを深めます。

1.  **3Dモデルの観察:**
    *   FreeCADを起動し、`optimal_building.FCStd`ファイルを開きます。
    *   PSOが設計した建物を、課題で指定されている視点（正面、側面、鳥瞰図など）からじっくり観察し、それぞれのスクリーンショットを撮ります。

2.  **レポート作成:**
    *   `kadai.md`の**提出課題1**の項目に従い、レポートを作成します。
    *   **a) 最適化プロセスの観察**: ステップ1の観察メモを元に記述します。
    *   **b) 最適化された建物の特徴**: ステップ2のパラメータと、ステップ4で観察した3Dモデルを見ながら分析します。
    *   **c) 評価結果の分析**: ステップ3の最後に記録した評価結果を元に、表を作成し、各指標の意味を説明します。

3.  **考察:**
    *   すべての結果を踏まえ、「なぜPSOはこの形状を最適だと考えたのか？」「人間の設計と何が違うか？」「もっと良くするにはどうすればいいか？」といった点について、**500字以上で考察**を記述します。

---

これで課題1は完了です。もし途中で不明な点やエラーが出た場合は、いつでも質問してください。
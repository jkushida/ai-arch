<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>Debug Mermaid</title>
  <script defer src="https://unpkg.com/mermaid@10/dist/mermaid.min.js"></script>
  <script defer>
    document.addEventListener('DOMContentLoaded', () => {
      console.log('DOMContentLoaded fired');
      console.log('mermaid object:', typeof mermaid);
      
      if (typeof mermaid !== 'undefined') {
        console.log('Initializing mermaid...');
        mermaid.initialize({ 
          startOnLoad: true,
          logLevel: 'debug'
        });
        
        // 手動で.mermaidクラスの要素を確認
        const mermaidElements = document.querySelectorAll('.mermaid');
        console.log('Found mermaid elements:', mermaidElements.length);
        mermaidElements.forEach((elem, index) => {
          console.log(`Element ${index} content:`, elem.textContent);
        });
      }
    });
  </script>
</head>
<body>
  <h1>Debug Mermaid Test</h1>
  
  <h2>Test 1: 改行なし</h2>
  <div class="mermaid">graph LR
    A[pso_config.py<br/>設定] --> B(pso_algorithm.py<br/>PSOループ)
    B --> C[generate_building_fem_analyze.py<br/>粒子の評価]
    C --> B
    B --> D((JSONデータ)) -- リアルタイム出力 --> E[monitor_pso_*.py<br/>監視スクリプト]</div>

  <h2>Test 2: 改行あり（PSO_usage.htmlと同じ）</h2>
  <div class="mermaid">
graph LR
    A[pso_config.py<br/>設定] --> B(pso_algorithm.py<br/>PSOループ)
    B --> C[generate_building_fem_analyze.py<br/>粒子の評価]
    C --> B
    B --> D((JSONデータ)) -- リアルタイム出力 --> E[monitor_pso_*.py<br/>監視スクリプト]
</div>

  <h2>Test 3: シンプルな図</h2>
  <div class="mermaid">
graph TD
    A[開始] --> B{条件分岐}
    B -->|Yes| C[処理1]
    B -->|No| D[処理2]
    C --> E[終了]
    D --> E
  </div>
</body>
</html>